openapi: 3.0.1
info:
  contact:
    email: info@flowpipe.io
    name: Flowpipe
    url: http://www.flowpipe.io
  description: Flowpipe is workflow and pipelines for DevSecOps.
  license:
    name: AGPLv3
    url: https://www.gnu.org/licenses/agpl-3.0.en.html
  title: Flowpipe
  version: 0.1.0
servers:
- url: https://localhost/api/v0
paths:
  /pipeline:
    get:
      description: Lists pipelines
      operationId: pipeline_list
      parameters:
      - description: "The max number of items to fetch per page of data, subject to\
          \ a min and max of 1 and 100 respectively. If not specified will default\
          \ to 25."
        explode: true
        in: query
        name: limit
        required: false
        schema:
          default: 25
          maximum: 100
          minimum: 1
          type: integer
        style: form
      - description: "When list results are truncated, next_token will be returned,\
          \ which is a cursor to fetch the next page of data. Pass next_token to the\
          \ subsequent list request to fetch the next page of data."
        explode: true
        in: query
        name: next_token
        required: false
        schema:
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListPipelineResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Forbidden
        "429":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Too Many Requests
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Internal Server Error
      summary: List pipelines
      tags:
      - Pipeline
  /pipeline/{pipeline_name}:
    get:
      description: Get pipeline
      operationId: pipeline_get
      parameters:
      - description: The name of the pipeline
        explode: false
        in: path
        name: pipeline_name
        required: true
        schema:
          format: "^[a-z_]{0,32}$"
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetPipelineResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Not Found
        "429":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Too Many Requests
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Internal Server Error
      summary: Get pipeline
      tags:
      - Pipeline
  /pipeline/{pipeline_name}/cmd:
    post:
      operationId: pipeline_cmd
      parameters:
      - description: The name of the pipeline
        explode: false
        in: path
        name: pipeline_name
        required: true
        schema:
          format: "^[a-z_]{0,32}$"
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CmdPipeline'
        description: Pipeline command.
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PipelineExecutionResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Not Found
        "429":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Too Many Requests
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Internal Server Error
      summary: Execute a pipeline command
      tags:
      - Pipeline
      x-codegen-request-body-name: request
  /process:
    get:
      description: Lists processs
      operationId: process_list
      parameters:
      - description: "The max number of items to fetch per page of data, subject to\
          \ a min and max of 1 and 100 respectively. If not specified will default\
          \ to 25."
        explode: true
        in: query
        name: limit
        required: false
        schema:
          default: 25
          maximum: 100
          minimum: 1
          type: integer
        style: form
      - description: "When list results are truncated, next_token will be returned,\
          \ which is a cursor to fetch the next page of data. Pass next_token to the\
          \ subsequent list request to fetch the next page of data."
        explode: true
        in: query
        name: next_token
        required: false
        schema:
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListProcessResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Forbidden
        "429":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Too Many Requests
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Internal Server Error
      summary: List processs
      tags:
      - Process
  /process/:process_id/log/process.sps:
    get:
      description: Get process snapshot
      operationId: process_get_snapshot
      parameters:
      - description: The id of the process
        explode: false
        in: path
        name: process_id
        required: true
        schema:
          format: "^[a-z]{0,32}$"
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/execution.Snapshot'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Not Found
        "429":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Too Many Requests
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Internal Server Error
      summary: Get process snapshot
      tags:
      - Process
  /process/{process_id}:
    get:
      description: Get process
      operationId: process_get
      parameters:
      - description: The name of the process
        explode: false
        in: path
        name: process_id
        required: true
        schema:
          format: "^[a-z]{0,32}$"
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Process'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Not Found
        "429":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Too Many Requests
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Internal Server Error
      summary: Get process
      tags:
      - Process
  /process/{process_id}/output:
    get:
      description: Get process output
      operationId: process_get_output
      parameters:
      - description: The name of the process
        explode: false
        in: path
        name: process_id
        required: true
        schema:
          format: "^[a-z]{0,32}$"
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProcessOutputData'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Not Found
        "429":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Too Many Requests
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Internal Server Error
      summary: Get process output
      tags:
      - Process
  /trigger:
    get:
      description: Lists triggers
      operationId: trigger_list
      parameters:
      - description: "The max number of items to fetch per page of data, subject to\
          \ a min and max of 1 and 100 respectively. If not specified will default\
          \ to 25."
        explode: true
        in: query
        name: limit
        required: false
        schema:
          default: 25
          maximum: 100
          minimum: 1
          type: integer
        style: form
      - description: "When list results are truncated, next_token will be returned,\
          \ which is a cursor to fetch the next page of data. Pass next_token to the\
          \ subsequent list request to fetch the next page of data."
        explode: true
        in: query
        name: next_token
        required: false
        schema:
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListTriggerResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Forbidden
        "429":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Too Many Requests
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Internal Server Error
      summary: List triggers
      tags:
      - Trigger
  /trigger/{trigger_name}:
    get:
      description: Get trigger
      operationId: trigger_get
      parameters:
      - description: The name of the trigger
        explode: false
        in: path
        name: trigger_name
        required: true
        schema:
          format: "^[a-z]{0,32}$"
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FpTrigger'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Not Found
        "429":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Too Many Requests
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Internal Server Error
      summary: Get trigger
      tags:
      - Trigger
  /variable:
    get:
      description: Lists variables
      operationId: variable_list
      parameters:
      - description: "The max number of items to fetch per page of data, subject to\
          \ a min and max of 1 and 100 respectively. If not specified will default\
          \ to 25."
        explode: true
        in: query
        name: limit
        required: false
        schema:
          default: 25
          maximum: 100
          minimum: 1
          type: integer
        style: form
      - description: "When list results are truncated, next_token will be returned,\
          \ which is a cursor to fetch the next page of data. Pass next_token to the\
          \ subsequent list request to fetch the next page of data."
        explode: true
        in: query
        name: next_token
        required: false
        schema:
          type: string
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListVariableResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Forbidden
        "429":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Too Many Requests
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Internal Server Error
      summary: List variables
      tags:
      - Variable
  /variable/{variable_name}:
    get:
      description: Get variable
      operationId: variable_get
      parameters:
      - description: The name of the variable
        explode: false
        in: path
        name: variable_name
        required: true
        schema:
          format: "^[a-z]{0,32}$"
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Variable'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Bad Request
        "401":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Unauthorized
        "403":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Forbidden
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Not Found
        "429":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Too Many Requests
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/perr.ErrorModel'
          description: Internal Server Error
      summary: Get variable
      tags:
      - Variable
components:
  schemas:
    CmdPipeline:
      example:
        args: "{}"
        args_string:
          key: args_string
        execution_mode: synchronous
        command: run
      properties:
        args:
          properties: {}
          type: object
        args_string:
          additionalProperties:
            type: string
          type: object
        command:
          enum:
          - run
          type: string
        execution_mode:
          enum:
          - synchronous
          - asynchronous
          type: string
      required:
      - command
      type: object
    FpTrigger:
      example:
        pipeline: pipeline
        documentation: documentation
        name: name
        description: description
        title: title
        type: type
        url: url
        tags:
          key: tags
      properties:
        description:
          type: string
        documentation:
          type: string
        name:
          type: string
        pipeline:
          type: string
        tags:
          additionalProperties:
            type: string
          type: object
        title:
          type: string
        type:
          type: string
        url:
          type: string
      type: object
    GetPipelineResponse:
      example:
        outputs:
        - depends_on:
          - depends_on
          - depends_on
          name: name
          sensitive: true
          value: "{}"
          resolved: true
        - depends_on:
          - depends_on
          - depends_on
          name: name
          sensitive: true
          value: "{}"
          resolved: true
        mod: mod
        documentation: documentation
        name: name
        description: description
        params:
          key:
            name: name
            description: description
            optional: true
        title: title
        steps:
        - "{}"
        - "{}"
        tags:
          key: tags
      properties:
        description:
          type: string
        documentation:
          type: string
        mod:
          type: string
        name:
          type: string
        outputs:
          items:
            $ref: '#/components/schemas/modconfig.PipelineOutput'
          type: array
        params:
          additionalProperties:
            $ref: '#/components/schemas/modconfig.PipelineParam'
          type: object
        steps:
          items:
            type: object
          type: array
        tags:
          additionalProperties:
            type: string
          type: object
        title:
          type: string
      type: object
    ListPipelineResponse:
      example:
        next_token: next_token
        items:
        - mod: mod
          documentation: documentation
          name: name
          description: description
          title: title
          tags:
            key: tags
        - mod: mod
          documentation: documentation
          name: name
          description: description
          title: title
          tags:
            key: tags
      properties:
        items:
          items:
            $ref: '#/components/schemas/ListPipelineResponseItem'
          type: array
        next_token:
          type: string
      type: object
    ListPipelineResponseItem:
      example:
        mod: mod
        documentation: documentation
        name: name
        description: description
        title: title
        tags:
          key: tags
      properties:
        description:
          type: string
        documentation:
          type: string
        mod:
          type: string
        name:
          type: string
        tags:
          additionalProperties:
            type: string
          type: object
        title:
          type: string
      type: object
    ListProcessResponse:
      example:
        next_token: next_token
        items:
        - pipeline: pipeline
          execution_id: execution_id
          status: status
        - pipeline: pipeline
          execution_id: execution_id
          status: status
      properties:
        items:
          items:
            $ref: '#/components/schemas/Process'
          type: array
        next_token:
          type: string
      type: object
    ListTriggerResponse:
      example:
        next_token: next_token
        items:
        - pipeline: pipeline
          documentation: documentation
          name: name
          description: description
          title: title
          type: type
          url: url
          tags:
            key: tags
        - pipeline: pipeline
          documentation: documentation
          name: name
          description: description
          title: title
          type: type
          url: url
          tags:
            key: tags
      properties:
        items:
          items:
            $ref: '#/components/schemas/FpTrigger'
          type: array
        next_token:
          type: string
      type: object
    ListVariableResponse:
      example:
        next_token: next_token
        items:
        - name: name
          type: type
        - name: name
          type: type
      properties:
        items:
          items:
            $ref: '#/components/schemas/Variable'
          type: array
        next_token:
          type: string
      type: object
    PipelineExecutionResponse:
      type: object
    Process:
      example:
        pipeline: pipeline
        execution_id: execution_id
        status: status
      properties:
        execution_id:
          type: string
        pipeline:
          type: string
        status:
          type: string
      type: object
    ProcessOutputData:
      example:
        output: "{}"
        process_id: process_id
      properties:
        output:
          properties: {}
          type: object
        process_id:
          type: string
      type: object
    Variable:
      example:
        name: name
        type: type
      properties:
        name:
          type: string
        type:
          type: string
      type: object
    execution.Snapshot:
      example:
        layout:
          children:
          - null
          - null
          panel_type: panel_type
          name: name
        schema_version: schema_version
        start_time: start_time
        panels:
          key:
            display_type: display_type
            data:
              columns:
              - data_type: data_type
                name: name
              - data_type: data_type
                name: name
              rows:
              - null
              - null
            panel_type: panel_type
            name: name
            width: 0
            title: title
            dashboard: dashboard
            properties: "{}"
            status: status
        end_time: end_time
      properties:
        end_time:
          type: string
        layout:
          $ref: '#/components/schemas/execution.SnapshotLayout'
        panels:
          additionalProperties:
            $ref: '#/components/schemas/execution.SnapshotPanel'
          type: object
        schema_version:
          type: string
        start_time:
          type: string
      type: object
    execution.SnapshotLayout:
      example:
        children:
        - null
        - null
        panel_type: panel_type
        name: name
      properties:
        children:
          items:
            $ref: '#/components/schemas/execution.SnapshotLayout'
          type: array
        name:
          type: string
        panel_type:
          type: string
      type: object
    execution.SnapshotPanel:
      example:
        display_type: display_type
        data:
          columns:
          - data_type: data_type
            name: name
          - data_type: data_type
            name: name
          rows:
          - null
          - null
        panel_type: panel_type
        name: name
        width: 0
        title: title
        dashboard: dashboard
        properties: "{}"
        status: status
      properties:
        dashboard:
          type: string
        data:
          $ref: '#/components/schemas/execution.SnapshotPanelData'
        display_type:
          type: string
        name:
          type: string
        panel_type:
          type: string
        properties:
          properties: {}
          type: object
        status:
          type: string
        title:
          type: string
        width:
          type: integer
      type: object
    execution.SnapshotPanelData:
      example:
        columns:
        - data_type: data_type
          name: name
        - data_type: data_type
          name: name
        rows:
        - null
        - null
      properties:
        columns:
          items:
            $ref: '#/components/schemas/execution.SnapshotPanelDataColumn'
          type: array
        rows:
          items:
            $ref: '#/components/schemas/execution.SnapshotPanelDataRow'
          type: array
      type: object
    execution.SnapshotPanelDataColumn:
      example:
        data_type: data_type
        name: name
      properties:
        data_type:
          type: string
        name:
          type: string
      type: object
    execution.SnapshotPanelDataRow:
      type: object
    modconfig.PipelineOutput:
      example:
        depends_on:
        - depends_on
        - depends_on
        name: name
        sensitive: true
        value: "{}"
        resolved: true
      properties:
        depends_on:
          items:
            type: string
          type: array
        name:
          type: string
        resolved:
          type: boolean
        sensitive:
          type: boolean
        value:
          type: object
      type: object
    modconfig.PipelineParam:
      example:
        name: name
        description: description
        optional: true
      properties:
        description:
          type: string
        name:
          type: string
        optional:
          type: boolean
      type: object
    perr.ErrorDetailModel:
      properties:
        location:
          type: string
        message:
          type: string
      type: object
    perr.ErrorModel:
      properties:
        detail:
          description: If we don't have required it comes out as pointer and there
            is a bug in the formatter
          type: string
        instance:
          type: string
        retryable:
          description: All errors are fatal unless specified
          type: boolean
        status:
          type: integer
        title:
          type: string
        type:
          type: string
        validation_errors:
          items:
            $ref: '#/components/schemas/perr.ErrorDetailModel'
          type: array
      required:
      - detail
      - instance
      - status
      - title
      - type
      type: object
  securitySchemes:
    ApiKeyAuth:
      in: header
      name: Authorization
      type: apiKey
